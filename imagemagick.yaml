package:
    name: imagemagick
    version: 7.1.1.21
    epoch: 0
    description: Tools and libraries for manipulating common image formats
    copyright:
        - license: ImageMagick
environment:
    contents:
        packages:
            - busybox
            - ca-certificates-bundle
            - build-base
            - automake
            - autoconf
            - chrpath
            - fftw-dev
            - fontconfig-dev
            - freetype-dev
            - ghostscript-dev
            - lcms2-dev
            - libjpeg-turbo-dev
            - libpng-dev
            - libtool
            - libwebp-dev
            - libx11-dev
            - libxext-dev
            - libxml2-dev
            - pango-dev
            - perl-dev
            - tiff-dev
            - zlib-dev
# We currently don't have support for the following
#            - libheif-dev
#            - libraw-dev
#            - librsvg-dev

var-transforms:
  - from: ${{package.version}}
    match: \.([^\.]*)$
    replace: "-$1"
    to: mangled-package-version

pipeline:
    - uses: fetch
      with:
        expected-sha256: 09402e5f17c6575ef9f010bb2e21ae1710f1f3426f115ad4317ee9129c32608e
        uri: https://github.com/ImageMagick/ImageMagick/archive/refs/tags/${{vars.mangled-package-version}}.tar.gz
    - uses: autoconf/configure
    - uses: autoconf/make
    - uses: autoconf/make-install
    - uses: strip

subpackages:

    - name: imagemagick-doc
      description: "ImageMagick documentation and manpages"
      pipeline:
        - uses: split/manpages
        - runs: |
            mkdir -p "${{targets.subpkgdir}}"/usr/share
            mv "${{targets.destdir}}"/usr/share/doc/ "${{targets.subpkgdir}}"/usr/share

    - name: imagemagick-static
      description: ImageMagick static libraries
      pipeline:
        - uses: split/static
    - name: imagemagick-dev
      description: ImageMagick dev headers
      pipeline:
        - uses: split/dev
      dependencies:
        runtime:
            - imagemagick
#    - name: imagemagick-c++
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-libs
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-perlmagick
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-perlmagick-doc
#      pipeline:
#        - uses: split/manpages
#      description: imagemagick manpages
#    - name: imagemagick-heic
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-jpeg
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-pango
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-pdf
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-raw
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-svg
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-tiff
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME
#    - name: imagemagick-webp
#      pipeline:
#        - uses: split/FIXME
#      description: imagemagick FIXME

update:
  enabled: true
  version-transform:
    - match: -
    - replace: \. 
  github:
    identifier: ImageMagick/ImageMagick
    use-tag: true
