package:
  name: docbook-xsl
  version: 1.79.2
  epoch: 0
  description: XML stylesheets for Docbook-xml transformations
  target-architecture:
    - all
  copyright:
    - paths:
        - "*"
      attestation: TODO
      license: custom
environment:
  contents:
    packages:
      - busybox
      - ca-certificates-bundle
      - build-base
      - automake
      - autoconf
      - docbook-xml
      - libxslt
      - libxml2-utils
pipeline:
  - uses: fetch
    with:
      uri: https://github.com/docbook/xslt10-stylesheets/releases/download/release%2F${{package.version}}/docbook-xsl-${{package.version}}.tar.gz
      expected-sha512: cd375e7a2339bcd9d24936b370c4371b351cab7c8a79044e785d0300dab75bed5a5c9b9076d4fba32d39b22535edfc6f449a7b1086139ad8bf54eab844b9434e
  - runs: |
      export _dest="${{targets.destdir}}"/usr/share/xml/docbook/xsl-stylesheets-${{package.version}}

      install -dm755 "$_dest"
      install -m644 VERSION VERSION.xsl "$_dest"/
      ln -s xsl-stylesheets-${{package.vrsion}} "${_dest%/*}/xsl-stylesheets"

      for dir in assembly common eclipse epub epub3 fo highlighting html \
        htmlhelp javahelp lib manpages params profiling roundtrip \
        template website xhtml xhtml-1_1 xhtml5; do

        install -dm755 $_dest/$dir
        for f in $dir/*.xml $dir/*.xsl $dir/*.dtd $dir/*.ent; do
          [ -e "$f" ] || continue
          install -m644 $f $_dest/$dir
        done
      done

      install -dm755 "${{targets.destdir}}"/etc/xml

      install -m644 -D COPYING \
        "${{targets.destdir}}"/usr/share/licenses/docbook-xsl/COPYING
