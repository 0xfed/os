package:
  name: eigen
  version: 3.4.0
  epoch: 0
  description: "Eigen is a C++ template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms."
  copyright:
    - license: Apache-2.0 AND BSD-3-Clause AND Minpack AND MPL-2.0

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - cmake

pipeline:
  - uses: git-checkout
    with:
      repository: https://gitlab.com/libeigen/eigen
      tag: ${{package.version}}
      expected-commit: 3147391d946bb4b6c68edd901f2add6ac1f31f8c

  - uses: cmake/configure

  - uses: cmake/build

  - uses: cmake/install

update:
  enabled: true
  release-monitor:
    identifier: 666

test:
  environment:
    contents:
      packages:
        - build-base
  pipeline:
    - name: Compile and Execute Test
      runs: |
        cat << 'EOF' > test_eigen.C
        #include <iostream>
        #include <eigen3/Eigen/Dense>

        using Eigen::MatrixXd;

        int main()
        {
          MatrixXd m(2,2);
          m(0,0) = 3;
          m(1,0) = 2.5;
          m(0,1) = -1;
          m(1,1) = m(1,0) + m(0,1);
          if(m(1,1) == 1.5) {
            std::cout << "Test Successful" << std::endl;
            return 0;
          }
          std::cout << "Test Failed" << std::endl;
          return 1;
        }
        EOF

        g++ -o test_eigen test_eigen.C
        ./test_eigen
